ssh-keygen -R hostname

LB : m1.large
Node: c3.2xlarge
Infra : m3.xlarge
Master : m1.large
Bastion: m1.medium 

Cluster 1:
etc/selinux/config 
SELINUX=enforcing

VMs you must use host names, and the host names that you use must match the output of the hostname -f command on each node.

Error while registering on all machines. 
Applied below fix on all machines.:
2016-12-17 11:57:57,719 [DEBUG] subscription-manager:16447 @connection.py:475 - Loaded CA certificates from /etc/rhsm/ca/: redhat-uep.pem
2016-12-17 11:57:57,720 [DEBUG] subscription-manager:16447 @connection.py:523 - Making request: GET /subscription/users/asaran%40redhat.com/owners
2016-12-17 12:00:04,923 [ERROR] subscription-manager:16447 @managercli.py:160 - Error during registration: [Errno 110] Connection timed out
2016-12-17 12:00:04,923 [ERROR] subscription-manager:16447 @managercli.py:161 - [Errno 110] Connection timed out
[root@asaran-clust-02-lb ~]# cat /etc/resolv.conf 
# Generated by NetworkManager
search osop.rhcloud.com
nameserver 172.19.23.4
Changed To 
[root@asaran-clust-02-lb ~]# cat /etc/resolv.conf 
# Generated by NetworkManager
search osop.rhcloud.com
nameserver 8.8.8.8
nameserver 172.19.23.4

# All Servers
# subscription-manager register --username=asaran@redhat.com --password=D******$
# subscription-manager list --available --matches '*OpenShift*'
# subscription-manager attach --pool=8a85f9874011071c01407da00b997cb2
# subscription-manager repos --disable="*"
# subscription-manager repos \
    --enable="rhel-7-server-rpms" \
    --enable="rhel-7-server-extras-rpms" \
    --enable="rhel-7-server-ose-3.3-rpms"
# yum install wget git net-tools bind-utils iptables-services bridge-utils bash-completion -y
# yum update -y
# yum install atomic-openshift-utils -y
Skipped LB and bastion server only for 3 below commands.
# yum install docker-1.10.3 -y
Edit the /etc/sysconfig/docker file 
Limit docker logs.
OPTIONS='--selinux-enabled --insecure-registry 172.30.0.0/16'
Use : sed -i '/OPTIONS=.*/c\OPTIONS="--selinux-enabled --insecure-registry 172.30.0.0/16  --log-opt max-size=1M --log-opt max-file=3"' \
/etc/sysconfig/docker

# Modify these options if you want to change the way the docker daemon runs
OPTIONS='--selinux-enabled --log-driver=journald'
Changed to:
# Modify these options if you want to change the way the docker daemon runs
OPTIONS="--selinux-enabled --insecure-registry 172.30.0.0/16"

Test the DNS servers listed in /etc/resolv.conf
[root@asaran-clust-02-master1 ~]# cat /etc/resolv.conf 
# Generated by NetworkManager
search osop.rhcloud.com
nameserver 8.8.8.8
nameserver 172.19.23.19
[root@asaran-clust-02-master1 ~]# dig asaran-clust-02-master1.osop.rhcloud.com @172.19.23.19 +short
172.19.23.26
[root@asaran-clust-02-master1 ~]# dig asaran-clust-02-infra1.osop.rhcloud.com @8.8.8.8 +short
[root@asaran-clust-02-master1 ~]# vi /etc/hosts
172.19.23.28 asaran-clust-02-node1.osop.rhcloud.com asaran-clust-02-node1
172.19.23.27 asaran-clust-02-infra1.osop.rhcloud.com asaran-clust-02-infra1
172.19.23.26 asaran-clust-02-master1.osop.rhcloud.com asaran-clust-02-master1
172.19.23.25 asaran-clust-02-bastion.osop.rhcloud.com asaran-clust-02-bastion
172.19.23.24 asaran-clust-02-lb.osop.rhcloud.com asaran-clust-02-lb
Now the dig command works:
[root@asaran-clust-02-master1 ~]# dig asaran-clust-02-master1.osop.rhcloud.com @172.19.23.19 +short
172.19.23.26
[root@asaran-clust-02-master1 ~]#

#Prepare the /etc/hosts to connect to internet and to connect to others hosts on 209* network

echo "209.132.183.44 xmlrpc.rhn.redhat.com" >> /etc/hosts
echo "23.204.148.218 content-xmlrpc.rhn.redhat.com" >> /etc/hosts
echo "209.132.183.49 subscription.rhn.redhat.com" >> /etc/hosts
echo "209.132.182.33 repository.jboss.org" >> /etc/hosts
echo "209.132.182.63 registry.access.redhat.com" >> /etc/hosts

Volume Group : https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Logical_Volume_Manager_Administration/LVM_definition.html
The underlying physical storage unit of an LVM logical volume is a block device such as a partition or whole disk. This device is initialized as an LVM physical volume (PV).
To create an LVM logical volume, the physical volumes are combined into a volume group (VG). This creates a pool of disk space out of which LVM logical volumes (LVs) can be allocated.

Create a mount point for NFS server for registry , metrics and logging.
Create a volume of 90 GB on openstack and attach it to bastion server.
fdisk -l <-- List the volumes.
fdisk /dev/vdb  -->use options -->n p w
mkfs.xfs /dev/vdb1 -f
blkid
get the UID and add it to /etc/fstab
UUID=0869ca42-d5d9-4cdb-b66d-9f13d5c27cca /exports          xfs     defaults        0 0
mkdir /exports
partprobe
mkfs.xfs /dev/vdb1
mount /exports
 df -h
 
 Now create volumes 1 per node and attach it to respective nodes.
cat <<EOF > /etc/sysconfig/docker-storage-setup
DEVS=/dev/vdc
VG=docker-vg
EOF

docker-storage-setup 

Verify your configuration. You should have a dm.thinpooldev value in the /etc/sysconfig/docker-storage file and a docker-pool logical volume:
# cat /etc/sysconfig/docker-storage

lvs
**** Check if docker restarts work.
systemctl stop docker
If there is any existing docker installed on the node previously, You want to remove it.
rm -rf /var/lib/docker/*
systemctl restart docker
systemctl status docker -l
reboot --> Should be done after yum updates.
****
Run on baastion the: 
ssh-keygen
for host in asaran-clust-02-master1.osop.rhcloud.com \
    asaran-clust-02-lb.osop.rhcloud.com \
    asaran-clust-02-node1.osop.rhcloud.com \
    asaran-clust-02-infra1.osop.rhcloud.com; \
    do ssh-copy-id -i ~/.ssh/id_rsa.pub $host; \
    done

Sample Ansible inventry file:
https://github.com/openshift/openshift-ansible/blob/master/inventory/byo/hosts.ose.example

echo "Running Asible"
ansible-playbook /usr/share/ansible/openshift-ansible/playbooks/byo/config.yml
* SSH failed.  Had t copy the pub file to authorized_keys manually on each node.
echo "making master node schedulable"
oadm manage-node $MASTERFQDN --schedulable=true

https://lb.nlytic.com:8443/login
Adding a local admin user to allow a user to login:
admin/admin and anuragadmin/Pass@123
oc login -u system:admin --config=/etc/origin/master/admin.kubeconfig

[root@asaran-clust-02-master1 ~]# vi /etc/origin/master/master-config.yaml 
[root@asaran-clust-02-master1 ~]# cat /etc/origin/master/htpasswd
[root@asaran-clust-02-master1 ~]# htpasswd /etc/origin/master/htpasswd admin
New password: 
Re-type new password: 
Adding password for user admin
oadm policy add-cluster-role-to-user cluster-admin (youruser)
for project level access: oadm policy add-role-to-user <role> <username> (in the current project)

***********
If you have a dns, you can give names to the hosts as an example
master.example.com
node1.example.com
node2.example.com

and point each one to their public ips from the dns server

Otherwise, just use private ip addresses as the node names. Don’t use openstack assigned node names as they don’t resolve across nodes. It does not work on OS1.







